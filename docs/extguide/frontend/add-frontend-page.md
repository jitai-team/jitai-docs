---
sidebar_position: 2
slug: add-frontend-page
---

# 新增前端页面类型

当JitAi开发框架中现有的页面类型无法满足特定业务需求时，开发者可以扩展新的页面类型。页面类型是比组件更高层次的抽象，用于创建具有特定技术栈或业务逻辑的完整页面。

本文以Vue页面类型为例，通俗易懂地讲解页面类型的开发流程和核心概念。

## 什么是页面类型

想象你要建一栋房子，页面类型就像是房子的"建造标准"：
- **常规页面**：像普通住宅，用拖拽组件就能搭建
- **Markdown页面**：像书房，专门展示文档内容
- **Vue全代码页面**：像高级定制房，用Vue技术完全自由设计

每种页面类型都有自己的"建造工具"和"使用规范"。

## 页面类型的4个组成部分

一个完整的页面类型需要4个部分，就像建房子需要设计师、建筑工人、装修工人和物业管理：

| 组成部分 | 比喻 | 实际作用 |
|---------|------|----------|
| **定义配置器** | 设计师咨询台 | 新建页面时填写基本信息（名称、位置等） |
| **增删改API** | 建筑工人 | 负责创建页面的基础代码模板 |
| **编辑器** | 装修工人 | 提供修改页面代码的工具界面 |
| **加载器** | 物业管理 | 在网站运行时真正显示页面内容 |

## 开发流程

### 用户使用流程
1. **创建页面**：点击"新建Vue页面" → 填写页面信息 → 自动生成Vue代码模板
2. **编辑页面**：打开页面编辑器 → 修改Vue代码 → 保存
3. **使用页面**：在网站中访问页面 → 页面正常显示

### 开发实现流程
这个流程背后需要开发者提前准备好4个部分：

1. **定义配置器**：提供一个表单让用户填写页面信息
2. **API逻辑**：根据用户填写的信息生成Vue代码模板
3. **编辑器**：提供代码编辑界面让用户修改代码
4. **加载器**：在运行时正确加载和显示Vue页面

## 目录结构设计

页面类型的文件需要分别放在IDE端（开发工具）和运行时端（网站使用）：

```shell
# IDE端：开发工具中的文件
pages/VueType/
├── DefineEditor/           # 定义配置器：新建页面的表单
├── Api/                   # API逻辑：生成代码模板
└── Editor/                # 编辑器：修改代码的界面

# 运行时端：网站运行时的文件  
pages/VueType/
├── e.json                 # 配置信息
├── index.ts               # 入口文件
└── PageWrapper.tsx        # 页面包装器
```

## 核心实现要点

### 1. 定义配置器
提供用户友好的表单界面：
```typescript
// 主要功能：收集用户输入的页面信息
const DefineEditor = () => {
    // 表单包含：页面名称、存放路径、页面标题等
    // 用户点击确定后，调用API创建页面
};
```

### 2. API逻辑（重点）
这是最核心的部分，负责生成符合规范的代码模板：

```typescript
// create.ts - 创建页面的核心逻辑
export default async function create(pageInfo) {
    // 根据用户输入信息，生成标准的Vue页面代码
    const templateCode = {
        'index.ts': `
            // 必须导出Render函数和PageCls类
            import { createApp } from "vue";
            import App from "./App.vue";
            
            const Render = (dom, page) => {
                // 将Vue应用挂载到指定DOM元素
                createApp(App, { page }).mount(dom);
            };
            
            export { Render, PageCls };
        `,
        'App.vue': `
            <template>
                <div>
                    <h1>Hello Vue页面！</h1>
                    <p>页面名称：{{page.title}}</p>
                </div>
            </template>
        `,
        'page.ts': `
            // 页面业务逻辑类
            class PageCls extends Jit.BasePage {
                // 在这里写页面的具体功能
            }
        `
    };
    
    // 保存这些代码文件
    await app.saveElement(templateCode);
}
```

**关键规范**：
- 必须导出`Render`函数：用于将页面渲染到网页DOM中
- 必须导出`PageCls`类：包含页面的业务逻辑
- 文件结构要标准化：index.ts作为入口，其他文件按需添加

### 3. 编辑器
提供代码编辑功能：
```typescript
const Editor = () => {
    // 获取页面的所有代码文件
    // 提供代码编辑器（支持语法高亮、自动补全等）
    // 监听文件修改，提示用户保存
};
```

### 4. 加载器
在运行时正确显示页面：
```typescript
const PageWrapper = ({ pageData }) => {
    // 创建页面实例
    // 调用页面的Render函数
    // 将页面渲染到页面容器中
    
    return <div ref={containerRef} />; // Vue内容会挂载到这里
};
```

## 特殊技术处理

### 依赖管理
Vue页面需要Vue运行时库，通过配置文件声明：
```json
{
  "depends": [
    "/path/to/vue.runtime.js",
    "/path/to/element-plus.css"
  ]
}
```
系统会在加载Vue页面前，先加载这些依赖文件。

### 页面生命周期
每个页面都有标准的生命周期：
1. **创建**：new PageCls() 创建页面实例
2. **初始化**：page.init() 初始化页面数据
3. **渲染**：Render(dom, page) 将页面显示到网页
4. **销毁**：page.destroy() 清理页面资源

## 开发步骤总结

1. **确定需求**：明确要支持什么技术栈（Vue/React/Angular等）
2. **设计模板**：确定新建页面时要生成什么样的代码结构
3. **实现API**：编写create方法，生成符合规范的代码模板
4. **开发编辑器**：提供修改代码的界面工具
5. **实现加载器**：确保页面在运行时能正确显示
6. **配置依赖**：如果需要特殊运行时，添加依赖声明

## 应用场景

通过这套架构，可以创建各种专门的页面类型：
- **图表页面**：专门展示数据可视化图表
- **3D页面**：支持Three.js的3D展示页面  
- **游戏页面**：集成游戏引擎的互动页面
- **报表页面**：专门的数据报表生成页面

每种页面类型都有自己的技术栈、代码模板和编辑工具，让不同技术背景的开发者都能快速上手。
